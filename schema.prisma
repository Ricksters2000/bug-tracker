datasource db {
  url = env("DATABASE_URL")
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id Int @id @default(autoincrement())
  firstName String
  lastName String
  email String @unique
  password String
  bio String?
  role UserRole
  tickets Ticket[]
  projects Project[]
  comments Comment[]
}

model Ticket {
  id Int @id @default(autoincrement())
  projectId Int
  title String
  priority Priority
  createdDate DateTime
  dueDate DateTime?
  content String?
  history Json[]
  project Project @relation(fields: [projectId], references: [id])
  assignedUsers User[]
  comments Comment[]
}

model Project {
  id Int @id @default(autoincrement())
  title String
  description String?
  createdDate DateTime
  dueDate DateTime?
  priority Priority
  tickets Ticket[]
  assignedUsers User[]
}

model Comment {
  id Int @id @default(autoincrement())
  userId Int
  ticketId Int
  message String
  user User @relation(fields: [userId], references: [id])
  ticket Ticket @relation(fields: [ticketId], references: [id])
}

model History {
  id Int @id @default(autoincrement())
  userId Int
  changedId Int
  type HistoryType
}

enum UserRole {
  admin
  projectManager
  developer
  submitter
}

enum Priority {
  low
  medium
  high
}

enum HistoryType {
  ticket
  project
}

enum TicketStatus {
  new
  testing
  reviewed
  development
  completed
}